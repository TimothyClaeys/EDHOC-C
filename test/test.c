#include <edhoc/edhoc.h>
#include <assert.h>

bool compare_arrays(const uint8_t a[], const uint8_t b[], int size) {
    for (int i = 0; i < size; i++) {
        if (a[i] != b[i]) return false;
    }
    return true;
}

int decode_message_1() {
    const uint8_t msg1[] = {0x01, 0x00, 0x58, 0x20, 0x89, 0x8f, 0xf7, 0x9a, 0x02, 0x06, 0x7a, 0x16, 0xea, 0x1e, 0xcc,
                            0xb9, 0x0f, 0xa5, 0x22, 0x46, 0xf5, 0xaa, 0x4d, 0xd6, 0xec, 0x07, 0x6b, 0xba, 0x02, 0x59,
                            0xd9, 0x04, 0xb7, 0xec, 0x8b, 0x0c, 0x40};
    const uint8_t g_x[] = {0x89, 0x8f, 0xf7, 0x9a, 0x02, 0x06, 0x7a, 0x16, 0xea, 0x1e, 0xcc, 0xb9, 0x0f, 0xa5, 0x22,
                           0x46, 0xf5, 0xaa, 0x4d, 0xd6, 0xec, 0x07, 0x6b, 0xba, 0x02, 0x59, 0xd9, 0x04, 0xb7, 0xec,
                           0x8b, 0x0c};

    EDHOC_Msg1 message;

    assert(EDHOC_Msg1_Decode(msg1, sizeof(msg1), &message));
    assert(message.method_corr == 1);
    assert(message.g_x_size == sizeof(g_x));
    assert(message.connection_idi == NULL);
    assert(compare_arrays(message.g_x, g_x, message.g_x_size));

    return 0;
}

int main(int argc, char **argv) {
    decode_message_1();
}
